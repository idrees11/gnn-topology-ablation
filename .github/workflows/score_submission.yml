commit-leaderboard:
  needs: scoring
  if: github.event_name == 'push' || github.event_name == 'workflow_dispatch'
  runs-on: ubuntu-latest

  steps:
    - name: Checkout main branch
      uses: actions/checkout@v3
      with:
        ref: main
        token: ${{ secrets.GITHUB_TOKEN }}

    - name: Copy updated leaderboard into repo path
      run: |
        # Ensure repo path exists
        mkdir -p leaderboard
        # Overwrite repo-tracked file with runner-generated file
        cp -f leaderboard/leaderboard.md leaderboard/leaderboard.md

    - name: Commit leaderboard
      run: |
        git config user.name "github-actions[bot]"
        git config user.email "action@github.com"
        git add leaderboard/leaderboard.md
        git diff --cached --quiet || git commit -m "Update leaderboard [skip ci]"

    - name: Push changes
      run: git push
